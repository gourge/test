方案：
1.活动发布同步库存到缓存中
2.下单交易减缓存库存
3.使用mq异步消息扣减数据库库存
存在的问题：
1.异步消息发送失败
2.扣减数据库操作失败
3.下单失败无法正确回补库存

库存最终一致性方案：
1.引入库存操作流水
2.引入事务性消息机制
存在的问题：
1.redis不可用时如何处理
2.扣减流水错误如何处理

高可用设计原则（由业务场景决定）：
1.宁可少卖，不能超卖（对于库存无法及时补足的情况，反之，宁可超卖，不能少卖）
方案：
1.redis库存可以比实际数据库少
2.超时释放（即超时则回滚redis库存）


流程：
减redis库存-->初始化库存流水-->发送减库存的事务消息-->在producer端发送完事务消息（处于prepared状态）后，执行创建订单。
如果创建订单成功，则该消息可被消费，否则回滚，该消息不可被消费
